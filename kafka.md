Kafka 是一個流平臺：在這個平臺上可以發布和訂閱數據流，並把它們保存起來、進行處理，這就是構建kafka的初衷。

企業級消息系統、打數據系統（如Hadoop）和數據集成或ETL工具

kafka作爲現代的分布式系統，kafka 以集羣的方式運行，可以自由伸縮，處理公司的所有應用程序。

kafka 集羣並不是一組獨立運行的broker，而是一個可以靈活伸縮的中心平臺，可以處理整個公司所有的數據流。

作爲數據連接層，kafka提供了數據傳遞保證——可復制、持久化，保留多長時間完全可以由你來決定

kafka的流式處理能力讓你只用很少的代碼就能夠動態地處理派生流和數據集

> 用於事件驅動微服務系統的消息總線、流逝應用和大規模數據管道

如何安裝和配置
如何使用kafka api
設計原則和可靠性保證
kafka 架構細節

先就獲取哪一類數據達成一致。只要獲取了數據，問題也就迎刃而解了。

* 發布與訂閱消息系統的概念：
    數據（消息）的發送者（發布者）不會直接把消息發送給接收者，這是發布與訂閱消息系統的一個特點
    
kafka 是基於發布與訂閱的消息系統。它一般被稱爲“分布式提交日志”或者“分布式流平臺”

kafka 數據是按照一定順序持久化保存的，可以按需讀取

kafka的數據單元被稱爲消息。可以把消息看成是數據庫裏的一個“數據行”或一條“記錄”。消息由字節數組組成。消息可以有一個可選的元數據，也就是鍵


消息被分批次寫入kafka。批次就是一組消息，這些消息屬於同一個主題和分區

kafka的消息通過主題進行分類。主題就好比數據庫的表，或者文件系統裏的文件夾。主題可以被分爲若幹個分區，一個分區就是一個提交日志。消息以追加的方式寫入分區，然後以先入先出的順序讀取。

## 發布與訂閱消息系統
降低架構復雜度


## 生產者和消費者
用於數據集成的Kafka Connect API
用於流式處理的Kafka Streams

**生產者**創建消息，發布者或寫入者
**消費者**讀取消息，訂閱者或讀者
消費者訂閱一個或多個主題，並按照消息生成的順序讀取它們
消費者是**消費者羣組**的一部分，會有一個或多個消費者共同讀取一個主題。
羣組保證每個分區只能被一個消費者使用。
消費者與分區之間的映射通常被稱爲消費者對分區的**所有權關系**

## broker 和集羣

一個獨立的Kafka 服務器被稱爲broker。
broker 接收來自生產者的消息，爲消息設置偏移量，並提交消息到磁盤保存。
broker 爲消費者提供服務，對讀取分區的請求作出響應，返回已經提交到磁盤上的消息。根據特定的硬件及其性能特徵，單個broker 可以輕鬆處理數千個分區以及每秒百萬級的消息量。

broker 是集羣的組成部分。每個集羣都有一個broker 同時充當了集羣控制器的角色（自動從集羣的活躍成員中選舉出來）。控制器負責管理工作，包括將分區分配給broker 和監控broker。在集羣中，一個分區從屬於一個broker，該broker 被稱爲分區的**首領**.
分區復制，復制機制爲分區提供了消息冗餘。

**保留消息**（在一定期限內）是Kafka 的一個重要特性。

## 多集羣
基於以下幾點原因，最好使用多個集羣
* 數據類型分離
* 安全需求隔離
* 多數據中心(災難恢復)

MirrorMaker工具，可以用它來實現集羣間的消息復制。核心組件包含了一個生產者和一個消費者，兩者之間通過一個隊列相連。消費者從一個集羣讀取消息，生產者把消息發送到另一個集羣上。

## 爲什麼選着Kafka
kafka 可以無縫地支持多個生產者，不管客戶端在使用單個主題還是多個主題。
kafka 也支持多個消費者從一個單獨的消息流上讀取數據，而且消費者之間互不影響。多個消費者可以組成一個羣組，它們共享一個消息流，並保證整個羣組對每個給定的消息只處理一次。
還允許消費者非實時地讀取消息，這要歸功與kafka 的數據保留特性。消息被提交到磁盤，根據設置的保留規則進行保存。
伸縮性
高性能

## 使用場景
活動跟蹤
傳遞消息
度量指標和日志記錄
提交日志
流處理

## 名詞
消息
偏移量
元數據
字節數組
緊湊型日志


---------
流程圖
```sequence
    前端服務器->度量指標服務器: 應用程序度量指標
    前端服務器->度量指標服務器: 應用程序度量指標
    end
```

```sequence
    Alice->John: Hello John, how are you?
    loop every minute
        John-->Alice: Great!
    end
```

```seq
Alice->Bob: Hello Bob, how are you?
Note right of Bob: Bob thinks
Bob-->Alice: I am good thanks!
```
--------------


流式處理[^1]


[^1]:  什 麼是流式處理